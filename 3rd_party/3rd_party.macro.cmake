# =========== 3rd_party ===========
if (NOT PROJECT_3RD_PARTY_PACKAGE_DIR)
    set (PROJECT_3RD_PARTY_PACKAGE_DIR "${CMAKE_CURRENT_LIST_DIR}/packages")
endif ()
if (NOT PROJECT_3RD_PARTY_INSTALL_DIR)
    set (PROJECT_3RD_PARTY_INSTALL_DIR "${CMAKE_CURRENT_LIST_DIR}/install/${PROJECT_PREBUILT_PLATFORM_NAME}")
endif ()

if (NOT EXISTS ${PROJECT_3RD_PARTY_PACKAGE_DIR})
    file(MAKE_DIRECTORY ${PROJECT_3RD_PARTY_PACKAGE_DIR})
endif ()

if (NOT EXISTS ${PROJECT_3RD_PARTY_INSTALL_DIR})
    file(MAKE_DIRECTORY ${PROJECT_3RD_PARTY_INSTALL_DIR})
endif ()

# =========== 3rd_party - libuv ===========
include("${PROJECT_3RD_PARTY_ROOT_DIR}/libuv/libuv.cmake")

# =========== 3rd_party - protobuf ===========
include("${PROJECT_3RD_PARTY_ROOT_DIR}/protobuf/protobuf.cmake")


# =========== 3rd_party - yaml-cpp ===========
include("${PROJECT_3RD_PARTY_ROOT_DIR}/yaml-cpp/yaml-cpp.cmake")

if (3RD_PARTY_PUBLIC_LINK_NAMES)
    list(REMOVE_DUPLICATES 3RD_PARTY_PUBLIC_LINK_NAMES)
    list(REVERSE 3RD_PARTY_PUBLIC_LINK_NAMES)
endif()
if (3RD_PARTY_INTERFACE_LINK_NAMES)
    list(REMOVE_DUPLICATES 3RD_PARTY_INTERFACE_LINK_NAMES)
    list(REVERSE 3RD_PARTY_INTERFACE_LINK_NAMES)
endif ()

# Copy executable/dll/.so files
file(GLOB 3RD_PARTY_JEMALLOC_ALL_DYNAMIC_LIB_FILES  
    "${PROJECT_3RD_PARTY_INSTALL_DIR}/lib/*.so*"
    "${PROJECT_3RD_PARTY_INSTALL_DIR}/lib/*.dll*"
    "${PROJECT_3RD_PARTY_INSTALL_DIR}/lib64/*.so*"
    "${PROJECT_3RD_PARTY_INSTALL_DIR}/lib64/*.dll*"
)
project_copy_shared_lib(${3RD_PARTY_JEMALLOC_ALL_DYNAMIC_LIB_FILES} ${PROJECT_INSTALL_SHARED_DIR})

if (NOT EXISTS "${PROJECT_INSTALL_BAS_DIR}/bin")
    file(MAKE_DIRECTORY "${PROJECT_INSTALL_BAS_DIR}/bin")
endif ()
file(GLOB 3RD_PARTY_JEMALLOC_ALL_DYNAMIC_BIN_FILES  
    "${PROJECT_3RD_PARTY_INSTALL_DIR}/bin/*.dll"
    ${3RD_PARTY_COPY_EXECUTABLE_PATTERN}
)

if (3RD_PARTY_JEMALLOC_ALL_DYNAMIC_BIN_FILES)
    list(REMOVE_DUPLICATES 3RD_PARTY_JEMALLOC_ALL_DYNAMIC_BIN_FILES)
    project_copy_shared_lib(${3RD_PARTY_JEMALLOC_ALL_DYNAMIC_BIN_FILES} "${PROJECT_INSTALL_BAS_DIR}/bin")
endif()
